<div class="min-h-screen bg-gray-50">
  <!-- Toast -->
  <p-toast></p-toast>
  
  <!-- Header -->
  <div class="bg-white border-b border-gray-200 sticky top-0 z-10">
    <div class="max-w-7xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between gap-3">
        <div class="flex items-center gap-3">
          <button class="p-2 hover:bg-gray-100 rounded-lg transition-colors" (click)="goBack()">
            <i class="pi pi-arrow-left text-blue-600"></i>
          </button>
          <h1 class="text-xl font-bold text-gray-900">Editar Actividad</h1>
        </div>
        <!-- Navegación rápida -->
        <div class="flex items-center gap-2">
          <a routerLink="/admin-tareas" class="px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-2">
            <i class="pi pi-list text-blue-600"></i>
            <span class="hidden sm:inline">Actividades</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading && !titulo" class="flex justify-center items-center py-20">
    <i class="pi pi-spin pi-spinner text-4xl text-blue-600"></i>
  </div>

  <!-- Formulario -->
  <div *ngIf="!isLoading || titulo" class="max-w-3xl mx-auto px-4 py-6">
    <div class="bg-white rounded-lg shadow-sm p-6">
      <div class="space-y-5">
        
        <!-- Título -->
        <div>
          <label class="text-sm font-medium text-gray-700 mb-2 block">
            Título de la actividad <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            [(ngModel)]="titulo"
            placeholder="Ej: Campaña de Navidad 2025"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [class.border-red-500]="titulo && titulo.trim().length < 5" />
          <p *ngIf="titulo && titulo.trim().length < 5" class="text-xs text-red-500 mt-1">
            El título debe tener al menos 5 caracteres
          </p>
        </div>

        <!-- Descripción -->
        <div>
          <label class="text-sm font-medium text-gray-700 mb-2 block">
            Descripción
          </label>
          <textarea
            [(ngModel)]="descripcion"
            placeholder="Describe los objetivos y detalles de la actividad..."
            rows="4"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
        </div>

        <!-- Sucursal -->
        <div>
          <label class="text-sm font-medium text-gray-700 mb-2 block">
            Sucursal
          </label>
          <p-select
            [(ngModel)]="sucursalId"
            [options]="sucursalesDisponibles"
            optionLabel="nombre"
            optionValue="id"
            placeholder="Seleccionar sucursal"
            [showClear]="true"
            styleClass="w-full">
          </p-select>
        </div>



        <!-- Fechas -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="text-sm font-medium text-gray-700 mb-2 block">
              Fecha de inicio <span class="text-red-500">*</span>
            </label>
            <p-datepicker
              [(ngModel)]="fechaInicio"
              [showIcon]="true"
              [showTime]="true"
              hourFormat="12"
              dateFormat="dd/mm/yy"
              placeholder="Seleccionar fecha y hora"
              styleClass="w-full">
            </p-datepicker>
          </div>
          
          <div>
            <label class="text-sm font-medium text-gray-700 mb-2 block">
              Fecha de fin
            </label>
            <p-datepicker
              [(ngModel)]="fechaFin"
              [showIcon]="true"
              [showTime]="true"
              hourFormat="12"
              dateFormat="dd/mm/yy"
              placeholder="Seleccionar fecha y hora"
              [minDate]="fechaInicio"
              styleClass="w-full">
            </p-datepicker>
          </div>
        </div>

      </div>

      <!-- Botones de acción -->
      <div class="flex gap-3 mt-6">
        <button 
          class="flex-1 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-gray-700 font-medium"
          (click)="goBack()">
          Cancelar
        </button>
        <button 
          class="flex-1 px-4 py-3 rounded-lg transition-colors font-medium"
          [class.bg-blue-600]="puedeGuardar && !isLoading"
          [class.text-white]="puedeGuardar && !isLoading"
          [class.hover:bg-blue-700]="puedeGuardar && !isLoading"
          [class.bg-gray-300]="!puedeGuardar || isLoading"
          [class.text-gray-500]="!puedeGuardar || isLoading"
          [class.cursor-not-allowed]="!puedeGuardar || isLoading"
          [disabled]="!puedeGuardar || isLoading"
          (click)="guardar()">
          <span *ngIf="!isLoading">Guardar Cambios</span>
          <span *ngIf="isLoading"><i class="pi pi-spin pi-spinner mr-2"></i> Guardando...</span>
        </button>
      </div>
    </div>
  </div>
</div>
